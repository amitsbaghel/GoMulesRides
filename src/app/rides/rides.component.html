<main role="main" class="container w-75">
  <div class="jumbotron">

    <div>

      <div class="form-row">
        <input #distance id="distance" class="col-6 form-control" type="text" placeholder="distance" aria-label="distance"
          readonly>
        <input #duration id="duration" class="col-6 form-control" type="text" placeholder="duration" aria-label="duration"
          readonly>
      </div>
      <hr>
    </div>
    <form class="form-inline mt-2 mt-md-0 justify-content-end">

      <input #fromcity class="form-control mr-sm-2" type="text" placeholder="From" aria-label="Search">
      <input #tocity class="form-control mr-sm-2" type="text" placeholder="To" aria-label="Search">
      <button (click)="search(fromcity.value,tocity.value)" class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
    </form>
    <hr>
    <div class="card">
      <div class="card-header">
        Rides
      </div>
      <div class="card-body">

        <!-- this card to repeat -->
        <div *ngFor="let ride of ridesDetails" class="card flex-md-row mb-4 shadow-sm h-md-250">
          <!-- [ngStyle]="{'background-color':ride.totalbookingseats == ride._id.overallseats  ? '#404041' : '' }" -->
          <div class="card-body d-flex flex-column align-items-start">
            <a class="text-dark" href="#">From {{ride._id.from}} to {{ride._id.to}}</a>
            <div class="mb-1 text-muted">{{ride._id.date | date:'MM/dd/yyyy'}} at {{ride._id.time | date:'hh:mm a' }}
            </div>
            <div class="mb-1 text-muted">Seats available {{ride._id.overallseats}} </div>
            <div class="mb-1 text-muted">Per person charge {{ride._id.chargeperseat | currency:'USD'}} </div>
            <div class="mb-1 text-muted">Uploaded by {{ride._id.name[0]}}</div>
            <div class="mb-1 text-muted">Seat remaining {{ride._id.overallseats-ride.totalbookingseats}}</div>

            <ul class="nav justify-content-center">
              <li class="nav-item">
                <button type="button" [disabled]="ride.totalbookingseats == ride._id.overallseats" (click)="totalSeat=ride._id.overallseats; remainingseats=ride._id.overallseats-ride.totalbookingseats;chargeperSeat=ride._id.chargeperseat;rideID=ride._id._id;seatselected=null;getUserData();open(content)"
                  class="btn btn-link nav-link active">Book</button>
              </li>
              <li class="nav-item">
                <a class="nav-link active" href="#">Communicate</a>
              </li>
            </ul>
          </div>
          <!-- <img class="card-img-right flex-auto d-none d-lg-block" data-src="holder.js/200x250?theme=thumb" alt="Thumbnail [200x250]" src="data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%22200%22%20height%3D%22250%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%20200%20250%22%20preserveAspectRatio%3D%22none%22%3E%3Cdefs%3E%3Cstyle%20type%3D%22text%2Fcss%22%3E%23holder_166b7fc8587%20text%20%7B%20fill%3A%23eceeef%3Bfont-weight%3Abold%3Bfont-family%3AArial%2C%20Helvetica%2C%20Open%20Sans%2C%20sans-serif%2C%20monospace%3Bfont-size%3A13pt%20%7D%20%3C%2Fstyle%3E%3C%2Fdefs%3E%3Cg%20id%3D%22holder_166b7fc8587%22%3E%3Crect%20width%3D%22200%22%20height%3D%22250%22%20fill%3D%22%2355595c%22%3E%3C%2Frect%3E%3Cg%3E%3Ctext%20x%3D%2256.1953125%22%20y%3D%22131%22%3EThumbnail%3C%2Ftext%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fsvg%3E" style="width: 200px; height: 250px;"> -->
        </div>
      </div>
    </div>

    <!-- modal pop up starts :: booking -->
    <ng-template #content let-modal>
      <div class="modal-header">
        <h4 class="modal-title" id="modal-basic-title">Ride Booking</h4>
        <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <ngb-alert *ngIf="booked" type="success" (close)="booked = null">You have successfully booked this ride. You can
        check in My Booking sections.</ngb-alert>

      <form #bookingForm="ngForm" (ngSubmit)="bookRide()">
        <div class="modal-body">
          <div class="form-row">
            <div class="form-group col">
              <label for="wallet">Wallet</label>
              <input class="form-control" name="wallet" type="text" value={{wallet}} readonly>
            </div>
            <div class="form-group col">
              <label for="seatsAvail">Seats Available</label>
              <input class="form-control" [(ngModel)]="remainingseats" name="seatsAvail" type="text" placeholder="seats Available"
                readonly>
            </div>
          </div>
          <div class="form-row">
            <div class="form-group col">
              <label for="seatselect">Select Seat</label>
              <input class="form-control" [(ngModel)]="seatselected" #seatselectedTemp="ngModel" greaterthan="seatsAvail"
                name="seatselect" type="text" required placeholder="Select Seats">
              <div *ngIf="seatselectedTemp.invalid && (seatselectedTemp.dirty || seatselectedTemp.touched)">
                <div class="invalid-feedback d-block" *ngIf="seatselectedTemp.errors.required">Seat is required.</div>
                <div class="invalid-feedback d-block" *ngIf="seatselectedTemp.errors.greaterthan">Value is greater than
                  the available seats.</div>
              </div>
            </div>

            <div class="form-group col">
              <label for="totalcharge">Charges per person {{chargeperSeat}} </label>
              <input class="form-control" #totalcharge="ngModel" [(ngModel)]="seatselected*chargeperSeat" greaterthan="{{wallet}}"
                name="totalcharge" type="text" placeholder="Calculated charges">
              <div *ngIf="totalcharge.invalid && (totalcharge.dirty || totalcharge.touched)">
                <div class="invalid-feedback d-block" *ngIf="totalcharge.errors.required">charge is required.</div>
                <div class="invalid-feedback d-block" *ngIf="totalcharge.errors.greaterthan"> You do not have
                  sufficient amount to book.Please recharge first.</div>
              </div>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <!-- <button type="button" class="btn btn-outline-dark" (click)="modal.close('Save click')">Book</button> -->
          <button class="btn btn-lg btn-primary btn-block" [disabled]="!bookingForm.form.valid" type="submit">Book</button>
        </div>
      </form>
      <!--form ends -->


    </ng-template>
    <!-- modal pop up ends :: booking -->
  </div>
</main>